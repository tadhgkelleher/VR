<!DOCTYPE html>
<html>
<head>
    <title>Network Space Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.4.2/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        .controls {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            color: white;
            font-family: Arial, sans-serif;
        }
        .toggle-button {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h2>Network Space Explorer</h2>
        <p>WASD/Arrows: Move | Mouse: Look | Space: Up | C: Down</p>
        <button class="toggle-button" onclick="togglePhysics()">Toggle Physics</button>
        <button class="toggle-button" onclick="toggleConnectionLines()">Toggle Connections</button>
    </div>
    
    <a-scene>
        <!-- Environment -->
        <a-sky color="#000033"></a-sky>
        
     <!-- Camera with enhanced movement -->
<a-entity position="0 0 20">
    <a-camera id="main-camera" 
              wasd-controls="fly: true; acceleration: 75; speed: 30; enabled: true;" 
              look-controls="reverseMouseDrag: false; mouseEnabled: true; touchEnabled: true; pointerLockEnabled: false; maxPitch: 90; minPitch: -90"
              cursor="rayOrigin: mouse" 
              position="0 1.6 0" 
              rotation="0 0 0">
        <a-cursor color="#4CC3D9"></a-cursor>

        <!-- Add smooth camera transitions -->
        <a-animation attribute="position" 
                     to="0 1.6 0" 
                     dur="500" 
                     easing="easeInOutQuad"></a-animation>
    </a-camera>
</a-entity>

        
        <!-- Ambient space lighting -->
        <a-light type="ambient" color="#222255" intensity="0.5"></a-light>
        <a-light type="directional" position="-1 1 1" intensity="0.8" color="#FFFFFF"></a-light>
        
        <!-- Stars background -->
        <a-entity id="stars"></a-entity>
        
        <!-- Nodes container -->
        <a-entity id="nodes"></a-entity>
    </a-scene>
   
    <script>
        // [Previous camera zoom controls remain the same]
        const camera = document.querySelector('#main-camera');
        const cameraEl = camera.getObject3D('camera');

        function adjustZoom(delta) {
            if (cameraEl) {
                const newFOV = Math.min(100, Math.max(20, cameraEl.fov + delta));
                cameraEl.fov = newFOV;
                cameraEl.updateProjectionMatrix();
            }
        }

        document.addEventListener('keydown', (event) => {
            if (event.key === '+' || event.key === '=') {
                adjustZoom(-5);
            } else if (event.key === '-' || event.key === '_') {
                adjustZoom(5);
            }
        });

        document.addEventListener('wheel', (event) => {
            adjustZoom(event.deltaY > 0 ? 5 : -5);
        });
    </script>
    <script>
        // Full dataset from original
        const items = [
            { "id": 1, "title": "Summerhill Dawn", "tags": ["Forget Me Nots", "video"], "videoUrl": "https://www.youtube.com/embed/NgAvUmezuC8" },
  { "id": 2, "title": "Trouble", "tags": ["Forget Me Nots", "video"], "videoUrl": "https://www.youtube.com/embed/LqgQawC0qCc" },
  { "id": 3, "title": "Beautiful Goodbye", "tags": ["Cilla Black", "RTE's Late Late Show", "video"], "videoUrl": "https://www.youtube.com/embed/I1WocWuNLVg" },
  { "id": 4, "title": "Single", "tags": ["Natasha Bedingfield", "RTE's Late Late Show", "video"], "videoUrl": "https://www.youtube.com/embed/3kXZc_isrBA" },
  { "id": 5, "title": "It's Nice to Be Nice", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/ap7Bklv8pB0" },
  { "id": 6, "title": "Shaman (Meditation)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/lz2hy0v5nBU" },
  { "id": 7, "title": "RTE's Late Late Show - Natasha Bedingfield - Single", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/3kXZc_isrBA" },
  { "id": 8, "title": "Smile", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/UNhLjsRurVc" },
  { "id": 9, "title": "There Are More Things", "tags": ["LiR", "video"], "videoUrl": "https://www.youtube.com/embed/7D51TGvo1jg" },
  { "id": 10, "title": "Muff Winwood took a trip and missed Woodstock", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/hfHnSofFpEI" },
  { "id": 11, "title": "Traveller", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/4Fl4AVab8MI" },
  { "id": 12, "title": "Traveller - Fan clip (2020)", "tags": ["LiR", "video"], "videoUrl": "https://www.youtube.com/embed/kpV02nfOqKU" },
  { "id": 13, "title": "Reverb: The Golden Horde profile on RTÃ‰", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/_PmMbWVzYK8" },
  { "id": 14, "title": "Prayer Before A Voyage (The Late Late Show)", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/BnDU3f4HxC8" },
  { "id": 15, "title": "Great Motivator", "tags": ["Igloo", "video"], "videoUrl": "https://www.youtube.com/embed/z5hDWKEqz_I" },
  { "id": 16, "title": "Falling At Your Feet (The Late Late Show) (2003)", "tags": ["U2", "video"], "videoUrl": "https://www.youtube.com/embed/m6auWD_U2bM" },
  { "id": 17, "title": "All Your Life", "tags": ["Bickley / O'Farrell", "video"], "videoUrl": "https://www.youtube.com/embed/t2KyyySk9Wg" },
  { "id": 18, "title": "Friends in Time", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/Emf_gmtMVZk" },
  { "id": 19, "title": "100 Boys", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/xmTPb18DubE" },
  { "id": 20, "title": "Endless Weekend", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/fKh0SA7iHCk" },
  { "id": 21, "title": "ETI (w/ live footage)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/c6KKVxqKzTU" },
  { "id": 22, "title": "Black Blade (live)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/Z-IlxQ6_Yj8" },
  { "id": 23, "title": "Down Down Down (live)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/2bZexBarD1o" },
  { "id": 24, "title": "Friends in Time", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/ZzCWjXomrhc" },
  { "id": 25, "title": "Book of Everlasting Things (unreleased demo)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/0_Fuiv9HohU" },
  { "id": 26, "title": "Rorschach (demo version)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/CjKrJ0oqDpQ" },
  { "id": 27, "title": "Solar System (live, bootleg)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/h3x_5VZ78jo" },
  { "id": 28, "title": "Louie, Louie/Hang On Sloopy: Johnny Thunders with The Golden Horde", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/mmZBy-R8g48" },
  { "id": 29, "title": "Something Beautiful (unreleased, demo)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/H0NVypxGVjw" },
  { "id": 30, "title": "Blitzkrieg Bop - Joey Ramone & the Resistance (live)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/6T11-Oip3Gw" },
  { "id": 31, "title": "Hopes of a Dream (unreleased, demo)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/x2_rsoGuUZQ" },
  { "id": 32, "title": "Cigarettes & Sunshine (unreleased, demo)", "tags": ["The Golden Horde", "video"], "videoUrl": "https://www.youtube.com/embed/EpwmsQnryL8" },
  { "id": 33, "title": "Niemali", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/7IRvFxznRw4" },
  { "id": 34, "title": "Killer Species", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/NOiYOwFcYUs" },
  { "id": 35, "title": "Shunk", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/uUJf1wXkEEQ" },
  { "id": 36, "title": "Spinning World", "tags": ["AVAN ATTAK", "video"], "videoUrl": "https://www.youtube.com/embed/thJC6FGYCzQ" },
  { "id": 37, "title": "Die Nebula", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/vylMvInak2k" },
  { "id": 38, "title": "Track With No Name", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/Qv1usZdAgKI" },
  { "id": 39, "title": "Kaos Split", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/Lv76RvHm_hk" },
  { "id": 40, "title": "Gold (from movie Once)", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/LLNhmjtOcC0" },
  { "id": 41, "title": "I Was Looking For Someone", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/_kn_N6Nxnh8" },
  { "id": 42, "title": "Love Song", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/qhqbc_YumSM" },
  { "id": 43, "title": "LIVE IN WHELANS 1990 [Full Gig]", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/Om0cT-5015U" },
  { "id": 44, "title": "#OnceCastEP: 'Gold' (London Cast of Once)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/71eLTe3tmow" },
  { "id": 45, "title": "Gold; Cork Opera House, Cork 02.02.17", "tags": ["Interference", "video"], "videoUrl": "https://www.youtube.com/embed/eAuf_e3b-HY" },
  { "id": 46, "title": "Wild Cat Strutting Thing - Mundy (Interference)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/v3nv1xboimg" },
  { "id": 47, "title": "Wild Cat Strutting Thing (feat. Fergus O'Farrell & James O'Leary)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/pDlpRG2JSgI" },
  { "id": 48, "title": "Vinegar Girl (feat. Fergus O'Farrell & James O'Leary)", "tags": ["video"], "videoUrl": "https://www.youtube.com/embed/LRF_aaiRQsA" },
  { "id": 49, "title": "No Reason (Official Music Video)", "tags": ["The Glee Club", "video"], "videoUrl": "https://www.youtube.com/embed/76sg_MzvIsw" },
  { "id": 50, "title": "The Blame", "tags": ["The Glee Club", "video"], "videoUrl": "https://www.youtube.com/embed/kXGTHDK8kpw" },
  { "id": 51, "title": "Main Work", "tags": ["RTE's Late Late Show", "Sony Music", "Warner Bros", "4AD", "Satanta Records", "Performing", "Recording", "Touring"] },
  { "id": 52, "title": "Rod Stewart", "tags": ["Drums", "TV"] },
  { "id": 53, "title": "Paul Young", "tags": ["Drums", "TV"] },
  { "id": 54, "title": "Kirsty MacColl", "tags": ["Artist"] },
  { "id": 55, "title": "Katie Melua", "tags": ["Artist", "TV"] },
  { "id": 56, "title": "The 4 Of Us", "tags": ["Drums", "Live", "Recording", "TV"] },
  { "id": 57, "title": "Gavin Friday", "tags": ["Artist"] },
  { "id": 58, "title": "Interference", "tags": ["Drums"] },
  { "id": 59, "title": "Grand Slam", "tags": ["Drums"] },
  { "id": 60, "title": "Mik Pyro", "tags": ["Artist"] },
  { "id": 61, "title": "The Dublin Blues Cartel", "tags": ["Drums"] },
  { "id": 62, "title": "The Golden Horde", "tags": ["Drums"] },
  { "id": 63, "title": "The Forget-Me-Nots", "tags": ["Drums", "TV", "Live"] },
  { "id": 64, "title": "Lir", "tags": ["Drums", "Live", "Recording", "TV", "BBC"] },
  { "id": 65, "title": "Mitch Easter", "tags": ["Producer", "REM", "Suzanne Vega", "Wilco"] },
  { "id": 66, "title": "Bungalow", "tags": ["Drums"] },
  { "id": 67, "title": "The Glee Club", "tags": ["Drums"] },
  { "id": 68, "title": "Mundy", "tags": ["Artist"] },
  { "id": 69, "title": "Glen Hansard", "tags": ["Artist"] },
  { "id": 70, "title": "Eamonn Dowd", "tags": ["Artist"] },
  { "id": 71, "title": "The Racketeers", "tags": ["Drums"] },
  { "id": 72, "title": "Darling Sugar Honey", "tags": ["Drums"] },
  { "id": 73, "title": "Hank Half Head", "tags": ["Drums", "Live", "Recording"] },
  { "id": 74, "title": "Alice Springs", "tags": ["Drums"] },
  { "id": 75, "title": "Tryst", "tags": ["Artist"] },
  { "id": 76, "title": "Donal Byrne", "tags": ["Artist"] },
  { "id": 77, "title": "John Murphy", "tags": ["Artist"] },
  { "id": 78, "title": "Hugh Doolin", "tags": ["Artist"] },
  { "id": 79, "title": "Sean O'Connor", "tags": ["Artist"] },
  { "id": 80, "title": "Pat Farrell", "tags": ["Artist"] },
  { "id": 81, "title": "John Quearney", "tags": ["Artist"] },
  { "id": 82, "title": "Thomas Walsh", "tags": ["Artist", "Ivo Novello Winner"] },
  { "id": 83, "title": "Robbie Malone", "tags": ["Artist", "David Gray"] },
  { "id": 84, "title": "Pete Wingfield", "tags": ["Producer", "Paul McCartney", "Everly Bros", "Van Morrison"] },
  { "id": 85, "title": "Pete Smith", "tags": ["Producer", "Sting", "The Police", "Duran Duran"] }
        ];

      // Calculate node sizes based on connections
        function calculateNodeSizes() {
            const connections = new Map();
            items.forEach(item => {
                connections.set(item.id, item.tags.length);
                item.tags.forEach(tag => {
                    connections.set(tag, (connections.get(tag) || 0) + .5);
                });
            });
            return connections;
        }

        function createStarfield() {
            const stars = document.querySelector('#stars');
            for (let i = 0; i < 1000; i++) {
                const star = document.createElement('a-sphere');
                const distance = Math.random() * 100 + 50;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.random() * Math.PI * 2;
                
                const x = distance * Math.sin(theta) * Math.cos(phi);
                const y = distance * Math.sin(theta) * Math.sin(phi);
                const z = distance * Math.cos(theta);
                
                star.setAttribute('position', `${x} ${y} ${z}`);
                star.setAttribute('radius', Math.random() * 0.1);
                star.setAttribute('color', '#FFFFFF');
                star.setAttribute('shader', 'flat');
                stars.appendChild(star);
            }
        }

        let connections = [];
        let nodeElements = new Map();
        let simulation;
        let showConnections = true;
        
        function createNode(x, y, z, title, isTag, id, connections) {
            const nodeEntity = document.createElement('a-entity');
            nodeEntity.setAttribute('position', `${x} ${y} ${z}`);
            nodeEntity.setAttribute('data-id', id);
            
            // Calculate size based on connections (normalized)
            const baseSize = isTag ? 0.4 : 0.6;
            const connectionCount = connections.get(id) || 1;
            const scaleFactor = 0.1 + (connectionCount * 0.1);
            
            // Create the sphere with glow
            const sphere = document.createElement('a-sphere');
            sphere.setAttribute('radius', baseSize * scaleFactor);
            
            // Color based on type and connections
            const hue = isTag ? 0 : 210;  // Red for tags, Blue for items
            const saturation = 70 + (connectionCount * 2);
            const brightness = 50 + (connectionCount * 3);
            sphere.setAttribute('color', `hsl(${hue}, ${saturation}%, ${brightness}%)`);
            
            // Add emission for glow effect
            sphere.setAttribute('material', 'emissive: #444; emissiveIntensity: 0.5');
            
            nodeEntity.appendChild(sphere);
            
            // Add text label
            const text = document.createElement('a-text');
            text.setAttribute('value', title);
            text.setAttribute('position', `0 ${baseSize * scaleFactor + 0.5} 0`);
            text.setAttribute('scale', `${0.5 * scaleFactor} ${0.5 * scaleFactor} ${0.5 * scaleFactor}`);
            text.setAttribute('align', 'center');
            text.setAttribute('color', 'white');
            text.setAttribute('look-at', '[camera]');
            nodeEntity.appendChild(text);
            
            nodeElements.set(id, nodeEntity);
            return nodeEntity;
        }

        function createCircularLayout() {
            const container = document.querySelector('#nodes');
            container.innerHTML = '';
            connections = [];
            nodeElements.clear();
            
            const nodeConnections = calculateNodeSizes();
            
            // Create outer circle of items
            const radius = 2;  // Larger radius for space-like feel
            const itemAngleStep = (2 * Math.PI) / items.length;
            
            items.forEach((item, index) => {
                const angle = itemAngleStep * index;
                // Add slight random variation to z for more 3D feel
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);
                const z = (Math.random() - 0.5) * 5;  // Random depth variation
                
                const node = createNode(x, y, z, item.title, false, item.id, nodeConnections);
                container.appendChild(node);
            });

            // Create inner circle of tags
            const uniqueTags = new Set(items.flatMap(item => item.tags));
            const tags = Array.from(uniqueTags);
            const tagRadius = radius * 0.2;  // Inner circle for tags
            const tagAngleStep = (2 * Math.PI) / tags.length;
            
            tags.forEach((tag, index) => {
                const angle = tagAngleStep * index;
                const x = tagRadius * Math.cos(angle);
                const y = tagRadius * Math.sin(angle);
                const z = (Math.random() - 0.5) * 3;  // Smaller depth variation for tags
                
                const node = createNode(x, y, z, tag, true, tag, nodeConnections);
                container.appendChild(node);
            });

            // Create connections
            items.forEach(item => {
                item.tags.forEach(tag => {
                    const startNode = nodeElements.get(item.id);
                    const endNode = nodeElements.get(tag);
                    if (startNode && endNode) {
                        const startPos = startNode.getAttribute('position');
                        const endPos = endNode.getAttribute('position');
                        const line = document.createElement('a-entity');
                        line.setAttribute('line', {
                            start: `${startPos.x} ${startPos.y} ${startPos.z}`,
                            end: `${endPos.x} ${endPos.y} ${endPos.z}`,
                            color: '#334455',
                            opacity: 0.2
                        });
                        container.appendChild(line);
                        connections.push({
                            element: line,
                            startId: item.id,
                            endId: tag
                        });
                    }
                });
            });
        }

        function toggleConnectionLines() {
            showConnections = !showConnections;
            connections.forEach(conn => {
                conn.element.setAttribute('visible', showConnections);
            });
        }

       function createForceSimulation() {
    const nodes = [];
    const links = [];
    const nodeConnections = calculateNodeSizes();

    // Use current positions as starting points for simulation
    nodeElements.forEach((element, id) => {
        const pos = element.getAttribute('position');
        const isTag = element.querySelector('a-sphere').getAttribute('radius') < 0.6;
        nodes.push({
            id: id,
            title: element.querySelector('a-text').getAttribute('value'),
            isTag: isTag,
            x: pos.x,
            y: pos.y,
            z: pos.z,
            connections: nodeConnections.get(id)
        });
    });

    items.forEach(item => {
        item.tags.forEach(tag => {
            links.push({
                source: nodes.find(n => n.id === item.id),
                target: nodes.find(n => n.id === tag)
            });
        });
    });

    return d3.forceSimulation(nodes)
        .force("link", d3.forceLink(links).distance(10).strength(0.1)) // Increase link distance
        .force("charge", d3.forceManyBody().strength(-10)) // Make nodes repel each other more
        .force("center", d3.forceCenter(0, 0).strength(2)) // Adjust center force
        .force("collide", d3.forceCollide(node => 1 + (node.connections || 1) * 0.8)) // Increase collision strength
        .velocityDecay(0.3)
        .alphaMin(0.001)
        .alphaDecay(0.01);
}
        // Initialize visualization
        document.querySelector('a-scene').addEventListener('loaded', function () {
            createStarfield();
            createCircularLayout();
        });

        function togglePhysics() {
            if (simulation) {
                simulation.stop();
                simulation = null;
                createCircularLayout();  // Reset to circular layout when physics is disabled
            } else {
                simulation = createForceSimulation();
                simulation.on('tick', () => {
                    simulation.nodes().forEach(node => {
                        const el = nodeElements.get(node.id);
                        if (el) {
                            el.setAttribute('position', `${node.x} ${node.y} ${node.z}`);
                        }
                    });
                    
                    if (showConnections) {
                        connections.forEach(conn => {
                            const start = nodeElements.get(conn.startId);
                            const end = nodeElements.get(conn.endId);
                            if (start && end) {
                                const startPos = start.getAttribute('position');
                                const endPos = end.getAttribute('position');
                                conn.element.setAttribute('line', {
                                    start: `${startPos.x} ${startPos.y} ${startPos.z}`,
                                    end: `${endPos.x} ${endPos.y} ${endPos.z}`,
                                    color: '#334455',
                                    opacity: 0.2
                                });
                            }
                        });
                    }
                });
            }
        }
    </script>

</body>
</html>
